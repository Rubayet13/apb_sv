###########################################################################
########################## Vivado Commands ################################
###########################################################################
###########################################################################

XVLOG				= /tools/Xilinx/Vivado/2023.2/bin/xvlog
XELAB				= /tools/Xilinx/Vivado/2023.2/bin/xelab
XSIM				= /tools/Xilinx/Vivado/2023.2/bin/xsim
HOME				= /home/ruba/github/apb_sv

###########################################################################
########################## File Compilation ###############################
###########################################################################
###########################################################################
	
COMPILE_ORDER		=\
						$(HOME)/rtl/apb.v \
						$(HOME)/tb/tb_top/apb_interface.sv \
						$(HOME)/tb/agent/agent_pkg.sv \
						$(HOME)/tb/env/env_pkg.sv \
						$(HOME)/tb/tb_top/apb_tb_top.sv \

###########################################################################
########################## Simulation Vars ################################
###########################################################################
###########################################################################

TOP_MODULE									= tb	
COMP_OPT									= --incr --relax
SIM_LOG										= -log simulate.log
ELAB_LOG									= -log elaborate.log
XVLOG_LOG         							= -log xvlog.log		
TEST_NAME									= apb_wr_rd_test 
TIMESCALE									= -timescale 1ns/1ps

###########################################################################
########################### Make Targets ##################################
###########################################################################
###########################################################################

compilation	:
			$(XVLOG) -sv $(COMPILE_ORDER) $(COMP_OPT)

elaboration	: compilation
			$(XELAB) $(TOP_MODULE) --relax -s top --debug typical 

simulate	: elaboration
			$(XSIM) top -runall
	
###########################################################################
######################### WAVES ARE CHECKED FROM GTKWAVE ##################
######################### USING TB_TOP GENERATED DUMPFILE #################
###########################################################################

clean: 
	@echo "---------------------------------Running Clean--------------------------------" 
	@rm -rf *.jou *.log *.pb *.wdb xsim.dir xsim.covdb xcrg_report *.vcd 				# This deletes all files generated by Vivado
	@rm -rf .*.timestamp  										# This deletes all our timestamps

# .PHONY		: clean
# .PHONY		: wave